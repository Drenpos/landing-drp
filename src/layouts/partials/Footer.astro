---
import ArrowBtn from "@/components/ArrowBtn.astro";
import Logo from "@/components/Logo.astro";
import config from "@/config/config.json";
import menu from "@/config/menu.json";
import social from "@/config/social.json";
import { markdownify } from "@/lib/utils/textConverter";
import CookieConsent from "@/components/cookies/CookieConsent.astro";


const { footer_rec_links, footer_company_links, footer_legal_links } = menu;

// Function to replace {year} this from string to year
function replaceYear(text: string) {
  const year = new Date().getFullYear();

  return text.replace("{year}", year.toString());
}
---

<footer class="bg-dark section-sm pb-11">
  <div class="container" data-aos="fade-up-sm">
    <div class="row gy-5 md:gy-6">
      <div class="lg:col-6 lg:pe-8">
        <div class="sm:max-w-sm">
          <Logo src={config.site.logo_footer} />
          {
            config.params.footer_description && (
              <p
                class="mt-3 mb-6 text-text-light/80"
                set:html={markdownify(config.params.footer_description)}
              />
            )
          }
          {
            config.subscription && config.subscription.enable && (
            <p class="mt-10 text-text-light font-medium text-lg">
              Subscribe to Our Newsletter!
            </p>
              <form
                action={config.subscription.form_action}
                method="post"
                class="flex justify-between rounded-full bg-body/5 px-3 py-2"
              >
                <input
                  type="email"
                  placeholder="Enter your email"
                  class="form-input text-text-light! w-full rounded-full !border-transparent bg-transparent py-2! pl-2! placeholder:!opacity-50 focus:ring-0"
                  required
                />
                <button
                  class="rounded-full bg-primary text-text-light px-4 py-1 font-medium transition hover:opacity-80 cursor-pointer"
                  type="submit"
                >
                  Subscribe
                </button>
              </form>
            )
          }
        </div>
      </div>
      <div class="lg:col-6">
        <div
          class="flex flex-col sm:flex-row gap-y-6 md:flex-nowrap flex-wrap justify-between"
        >
          <div>
            <h3 class="mb-4 pt-2 text-lg font-medium text-text-light md:mb-6">
              Recursos
            </h3>
            <ul class="flex flex-col gap-3">
              {
                footer_rec_links.map((item) => (
                  <li>
                    <ArrowBtn
                      label={item.name}
                      link={item.url}
                      blank={item.blank}
                    />
                  </li>
                ))
              }
            </ul>
          </div>
          <div>
            <h3 class="mb-4 pt-2 text-lg font-medium text-text-light md:mb-6">
              Empresa
            </h3>
            <ul class="flex flex-col gap-3">
              {
                footer_company_links.map((item) => (
                  <li>
                    <ArrowBtn label={item.name} link={item.url} />
                  </li>
                ))
              }
            </ul>
          </div>
          <div>
            <h3 class="mb-4 pt-2 text-lg font-medium text-text-light md:mb-6">
              Legal
            </h3>
            <ul class="flex flex-col gap-3">
              {
                footer_legal_links.map((item) => (
                  <li>
                    <ArrowBtn
                      label={item.name}
                      link={item.url}
                      blank={item.blank}
                      data_cc={item["data-cc"]}
                    />
                  </li>
                ))
              }
            </ul>
          </div>
          <div>
            <h3 class="mb-4 pt-2 text-lg font-medium text-text-light md:mb-6">
              Social Media
            </h3>
            <ul class="flex flex-col gap-3">
              {
                social.main.map((item) => (
                  <li>
                    <ArrowBtn label={item.name} link={item.link} blank={true} />
                  </li>
                ))
              }
            </ul>
          </div>
        </div>
      </div>
    </div>

    {
      config.params.copyright && (
        <div
          class="text-center text-sm text-white mt-10 md:mt-20 pt-4 border-t border-border/10 [&>a]:underline"
          set:html={markdownify(replaceYear(config.params.copyright))}
        />
      )
    }
  </div>
    
</footer>
